# Bitsafe - Live Builder auto build script

. ./bitsafe.build.conf

lb config noauto \
--apt apt \
--apt-indices false \
--apt-recommends disabled \
--architecture $PRECONF_ARCHITECTURE \
--linux-flavours $PRECONF_SUBARCH \
--hdd-size $PRECONF_TARGETSIZE \
--distribution wheezy \
--includes none \
--memtest none \
--binary-images iso-hybrid \
--archive-areas "main non-free" \
--cache-stages bootstrap \
--debian-installer false \
--iso-preparer "Debian" \
--iso-application "BitSafe" \
--cache-indices false \
--tasksel none \
--win32-loader false \
--bootstrap-flavour minimal \
 || exit 2

#--hdd_label="BITSAFE" \
#--volatile true \
#--security true \
#--packages-lists "minimal" \
#--syslinux-splash "contrib/media/syslinux_splash.png" \
#--hostname bitsafe \

# I don't need boot parameter, i create a custom menulist for syslinux later on in the build with hooks

# I need non-free repos for firmware-iwlwifi package with firmware for some intel wifi cards
# If you don't need it, you can remove both the repo from here and the package in 
# src/chroot_local-packageslists/bitsafe.list

#Copy all source configuration files to config folder
cp -a src/* config/

#Copy bitsafe configuration files in the bitsafe image
cat bitsafe.live.conf >>config/includes.chroot/usr/share/bitsafe/bitsafe.live.conf
cp bitsafe.build.conf config/includes.chroot/usr/share/bitsafe/

#Copy localizations 
cp localizations/bitsafe/*.po config/includes.chroot/usr/share/bitsafe/localizations

#Set label
sed 's/LB_HDD_LABEL=.*/LB_HDD_LABEL="BITSAFE"/' -i config/binary
